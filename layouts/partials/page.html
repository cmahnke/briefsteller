{{- $page := .Page -}}
{{- $class := .Params.type -}}
{{- $context := path.Dir .File.Path -}}
{{- $pageURL := .Permalink -}}
<div class="post-container post {{ $class }}">
    <div class="content">
        {{- if not .Params.metaPage -}}
            <div class="date">
                {{- partial "date.html" (dict "date" .Date "language" $.Page.Language "months" $.Site.Data.months) -}}
            </div>
        {{- end -}}
        <h1 class="post-title">{{ .Title }}</h1>
         {{- if not .Params.metaPage -}}
            <div class="date">
                <a href="{{ .RelPermalink }}">{{- partial "date.html" . -}}</a>
            </div>
        {{- end -}}
        <div class="post-body">
            {{ .Content }}
        </div>


        {{- if .Params.iiif -}}
            <div class="iiif">
              {{- range .Params.resources -}}
                {{- if or (and (ne $.Params.type "work") (ne $.Params.type "book")) (not (or (or (eq .name "front") (eq .name "title")) (eq .name "cover"))) -}}
                  {{- if .params.iiif -}}
                    {{ partial "iiif/iiif-image.html" (dict "context" . "contextPath" $context "pageURL" .Permalink "pageContext" $page "site" $.Site) }}
                  {{- end -}}
                {{- end -}}
              {{- end -}}
            </div>
        {{- end -}}

        {{- if and .Params.type (or .Params.description .Params.bookTitle) -}}
          <div class="{{ .Params.itemType }}-description">
            {{- if eq .Params.type "book" -}}
                <h2>{{ i18n "aboutTheNeu" }} {{ i18n "book" }}</h2>
                <h3 class="book-title">{{ .Params.bookTitle }}</h3>
            {{- else if eq .Params.itemType "postcard" -}}
                <h2>{{ i18n "aboutTheNeu" }} {{ i18n "postcard" }}</h2>
            {{- else if eq .Params.itemType "other" -}}
                <h2>{{ i18n "aboutTheFem" }} {{ i18n "other" }}</h2>
            {{- end -}}

            {{- if .Params.itemDescription -}}
                {{- .Params.itemDescription | markdownify -}}
            {{- else if .Params.description -}}
                {{- .Params.description | markdownify -}}
            {{- end -}}
          </div>
        {{- end -}}

        {{- if or (eq .Params.type "book") -}}
          <div class="book-description-images">
            {{- range .Params.resources -}}
              {{- if or (or (eq .name "front") (eq .name "title")) (eq .name "cover") -}}
                {{ partial "iiif/iiif-image.html" (dict "context" . "contextPath" $context "pageURL" .Permalink "pageContext" $page  "site" $.Site) }}
              {{- end -}}
            {{- end -}}
          </div>
        {{- end -}}
        </div>
        {{- if not .Params.metaPage -}}
            <div class="meta">
              {{ partial "meta/tags.html" . }}
            </div>
        {{ end }}
     </div>

</div>
