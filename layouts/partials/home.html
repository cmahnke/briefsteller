{{ $pages := .Site.Pages }}
<div class="shelf-container">
    <div class="shelf">
        <ul class="book-list">
          {{- range where $pages "Params.type" "eq" "book" -}}
            {{- $title := .Params.title -}}
            {{- $front := .Resources.GetMatch "front*" -}}
            {{- $thumb := $front.Resize "330x" -}}
            {{- $large := $front.Resize "1600x" -}}
            {{- $content := (partial "li.html" .) -}}
            {{- $id := delimit (shuffle (seq 1 9)) "" -}}
            <li data-content-id="{{ $id }}">
              <div class="context">
              <div class="wrap">
                  <div class="book preview">
                      <a href="#" data-href="{{ .RelPermalink }}">
                          <img class="preview" src="{{ $thumb.RelPermalink }}" alt="{{ .Title }}" data-image="{{ $large.RelPermalink }}"/>
                      </a>
                  </div>
                  <div class="book-back" style="background-image: url({{ safeCSS $thumb.RelPermalink }});"></div>
                  <div class="post-content" id="{{ $id }}">{{ $content | safeHTML }}</div>
              </div>
              </div>
            </li>
          {{ end }}
        </ul>
        <script type="text/javascript">
                $('.book.preview').each(function () {
                    $(this).click(function (event) {
                        var link = $(this).children('a');
                        link.attr('href', link.data('href'));
                        event.preventDefault();
                        $(this).off();
                    });
                });
        </script>
    </div>
</div>
{{- $pages := where (where .Site.Pages "Params.displayInList" "!=" false) "Params.type" "eq" "text" -}}

{{- $paginator := .Paginate $pages -}}
<div class="post-list">
  {{- range $paginator.Pages  -}}
      {{ partial "page.html" . }}
  {{ end }}
</div>
{{ if or ($paginator.HasPrev) ($paginator.HasNext) -}}
  <div class="navi">
      <div class="pagination">
          <div>
            {{ if $paginator.HasNext }}
              <a class="next" href="{{ $paginator.Next.URL }}">&laquo;Vorige Seite</a>
            {{ end }}
            {{- $currentPage := $paginator.PageNumber -}}
            {{- $totalPages := $paginator.TotalPages -}}
            <span id="page">Seite {{ $currentPage }} von {{ $totalPages }}</span>
            {{ if $paginator.HasPrev }}
              <a class="previous" href="{{ $paginator.Prev.URL }}">NÃ¤chste Seite&raquo;</a>
            {{ end }}
        </div>
    </div>
  </div>
{{- end }}
